"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Cacheable = void 0;
require("reflect-metadata");
const utils_1 = require("../utils");
const types_1 = require("../types");
const cacheable_1 = require("../utils/cacheable");
function Cacheable(timeout = 0, resultType = types_1.ResultType.Detect) {
    return function CacheDecorator(target, key, descriptor) {
        let isPromise = false;
        if (resultType === types_1.ResultType.Detect) {
            const type = Reflect.getMetadata('design:returntype', target, key);
            if (type && utils_1.isAsyncOrPromise(type)) {
                isPromise = true;
            }
        }
        else {
            isPromise = resultType === types_1.ResultType.Promise;
        }
        descriptor.value = cacheable_1.cacheable(descriptor.value, timeout, isPromise);
        return descriptor;
    };
}
exports.Cacheable = Cacheable;
//# sourceMappingURL=Cacheable.js.map